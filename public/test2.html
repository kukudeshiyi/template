<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"
    />
    <link
      rel="stylesheet"
      href="https://static.test.mitra.shopee.co.id/dp-configuration/invoice/lib/main.css"
      type="text/css"
    />
    <link
      rel="preload"
      href="https://static.test.mitra.shopee.co.id/apc-mitra/material/d3d36499-6a42-ad76-3846-76cb0fd1e014"
      as="image"
    />
  </head>
  <body>
    <div id="container" style="padding: 0 0.8rem">
      <div
        data-id=""
        style="padding-top: 0.5rem; padding-bottom: 0.4rem; text-align: center"
        class="image-wrap"
      >
        <img
          src="https://static.test.mitra.shopee.co.id/apc-mitra/material/d3d36499-6a42-ad76-3846-76cb0fd1e014"
          alt=""
          class="image-type gray"
          crossorigin="anonymous"
        />
      </div>
      <div
        style="
          padding-top: 0;
          padding-bottom: 0.4rem;
          font-size: 1.1rem;
          font-weight: bold;
          text-align: center;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="only-value-content">Hellotest211</span>
      </div>
      <div
        style="
          font-size: 1rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="only-value-content">Google Play 20000</span>
      </div>
      <div
        style="
          font-size: 1rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="label">Waktu Dibuat</span>
        <span class="separator">:</span>
        <span class="content">01/03/2021 14:54:48</span>
      </div>
      <div
        style="
          font-size: 1rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="label">Username Staf</span>
        <span class="separator">:</span> <span class="content">Admin</span>
      </div>
      <div data-id="" style="padding-top: 0rem; padding-bottom: 0.5rem">
        <div class="dash-type"></div>
      </div>
      <div
        style="
          text-align: center;
          font-size: 1rem;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="static-type"
      >
        <p>Kode Voucher</p>
      </div>
      <div
        style="
          font-size: 1.2rem;
          text-align: center;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
          font-weight: bold;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="only-value-content">1614 5852 9793 0957 31</span>
      </div>
      <div data-id="" style="padding-top: 0rem; padding-bottom: 0.5rem">
        <div class="dash-type"></div>
      </div>
      <div
        style="
          text-align: center;
          font-size: 1rem;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="static-type"
      >
        <p>Serial Number</p>
      </div>
      <div
        style="
          font-size: 1.2rem;
          text-align: center;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
          font-weight: bold;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="only-value-content">{mic ro_t imes tamp ()}6 9573 2</span>
      </div>
      <div data-id="" style="padding-top: 0rem; padding-bottom: 0.5rem">
        <div class="dash-type"></div>
      </div>
      <div
        style="
          font-size: 1rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="label">No. Pesanan</span> <span class="separator">:</span>
        <span class="content">APC1614585288069470930</span>
      </div>
      <div
        style="
          font-size: 1rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="label">Kategori</span> <span class="separator">:</span>
        <span class="content">GAME EPIN</span>
      </div>
      <div
        style="
          font-size: 1rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="label">No. Ref</span> <span class="separator">:</span>
        <span class="content">1614585288668600069</span>
      </div>
      <div data-id="" style="padding-top: 0rem; padding-bottom: 0.5rem">
        <div class="dash-type"></div>
      </div>
      <div
        style="
          font-size: 1.2rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0rem;
          font-weight: bold;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="label">Total Bayar</span> <span class="separator">:</span>
        <span class="content">Rp 26.000</span>
      </div>
    </div>
    <iframe src="#" id="iframe" style="display: none"></iframe>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
      var originalPostMessage = window.postMessage;
      var patchedPostMessage = function (message, targetOrigin, transfer) {
        originalPostMessage(message, targetOrigin, transfer);
      };
      patchedPostMessage.toString = function () {
        return String(Object.hasOwnProperty).replace(
          'hasOwnProperty',
          'postMessage'
        );
      };
      window.postMessage = patchedPostMessage;
    </script>
    <script>
      (function () {
        var iframe = document.getElementById('iframe');
        var imageCount = document.images.length;
        var failedImage = [];
        var successfulImage = [];
        var failed = false;
        var SUCCESSFUL_URL =
          'shopee://com.print.image.load/success?data=' +
          encodeURIComponent('{}');
        var FAILED_URL =
          'shopee://com.print.image.load/failure?data=' +
          encodeURIComponent('{}');

        function sendMessage(msg, maxNum) {
          var num = 0;
          maxNum = maxNum || 20;
          var interval = setInterval(() => {
            if (num > maxNum) {
              clearInterval(interval);
            }
            window.postMessage(msg);
            num++;
          }, 1000);
        }

        function getCapture() {
          html2canvas(document.body, {
            allowTaint: true,
            useCORS: true,
          }).then((canvas) => {
            var imageUrl = canvas.toDataURL();
            sendMessage('error');
          });
        }

        var timer = setTimeout(function () {
          if (successfulImage.length !== imageCount) {
            sendMessage('error');
            iframe.src = FAILED_URL;
            failed = true;
          }
        }, 7000);

        if (imageCount === 0) {
          clearTimeout(timer);
          getCapture();
          iframe.src = SUCCESSFUL_URL;
        }

        for (var index = 0; index < imageCount; index++) {
          const imageOnLoad = function () {
            if (failed) return;
            successfulImage.push(image);
            if (successfulImage.length === imageCount) {
              clearTimeout(timer);
              getCapture();
              iframe.src = SUCCESSFUL_URL;
            }
          };
          var image = document.images[index];
          if (image.complete) imageOnLoad();
          image.onload = imageOnLoad;
          image.onerror = function () {
            sendMessage('error');
            iframe.src = FAILED_URL;
            failedImage.push(image);
          };
        }
        var ua = navigator.userAgent;
        function isAndroid() {
          return /Android/i.test(ua);
        }
        function isIos() {
          return /iPhone|iPad|iPod|iOS/i.test(ua);
        }
        function isWeb() {
          return /windows|win32|win64|wow32|wow64|macintosh|macintel|x11/i.test(
            ua
          );
        }
        function getPlatform() {
          if (isWeb()) return 'web';
          if (isAndroid()) return 'android';
          if (isIos()) return 'ios';
          return '';
        }
        var page = document.querySelector('#container');
        var classList = page.getAttribute('class');
        page.setAttribute(
          'class',
          classList ? classList + ' ' + getPlatform() : getPlatform()
        );
      })();
    </script>
  </body>
</html>
