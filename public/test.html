<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"
    />
    <title>Receipt</title>
    <link
      rel="stylesheet"
      href="https://static.test.mitra.shopee.co.id/dp-configuration/invoice/lib/main.css"
      type="text/css"
    />
    <link
      rel="preload"
      href="https://static.test.mitra.shopee.co.id/apc-mitra/material/0465beaf-133a-7a75-0dde-43f2dc8a9868"
      as="image"
    />
  </head>
  <body>
    <div id="container" style="padding: 0 0.8rem">
      <div
        data-id=""
        style="padding-top: 0.5rem; padding-bottom: 0.8rem; text-align: center"
        class="image-wrap"
      >
        <img
          src="https://static.test.mitra.shopee.co.id/apc-mitra/material/0465beaf-133a-7a75-0dde-43f2dc8a9868"
          alt=""
          class="image-type gray"
        />
      </div>
      <div
        style="
          padding-top: 0;
          padding-bottom: 0.4rem;
          font-size: 1.1rem;
          font-weight: bold;
          text-align: center;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="only-value-content">HelloWorldStore</span>
      </div>
      <div
        style="
          font-size: 1rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="only-value-content">Steam 12.000</span>
      </div>
      <div
        style="
          font-size: 1rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="label">Waktu Dibuat</span>
        <span class="separator">:</span>
        <span class="content">09/06/2021 17:47:14</span>
      </div>
      <div
        style="
          font-size: 1rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="label">Username Staf</span>
        <span class="separator">:</span>
        <span class="content">haoyu.jin:shi</span>
      </div>
      <div data-id="" style="padding-top: 0rem; padding-bottom: 0.5rem">
        <div class="dash-type"></div>
      </div>
      <div
        style="
          text-align: center;
          font-size: 1rem;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="static-type"
      >
        <p>Kode Voucher</p>
      </div>
      <div
        style="
          font-size: 1.2rem;
          text-align: center;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
          font-weight: bold;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="only-value-content"
          >seri al01 5979 7823 8535 4014 535</span
        >
      </div>
      <div data-id="" style="padding-top: 0rem; padding-bottom: 0.5rem">
        <div class="dash-type"></div>
      </div>
      <div
        style="
          padding-top: 0rem;
          padding-bottom: 0.5rem;
          font-size: 1rem;
          font-weight: normal;
          text-align: center;
        "
        data-id=""
        class="static-type"
      >
        <p>PIN</p>
      </div>
      <div
        style="
          font-size: 1.2rem;
          font-weight: bold;
          text-align: center;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="only-value-content"
          >Code 1ser ial0 1597 9782 3853 5401 4535</span
        >
      </div>
      <div data-id="" style="padding-top: 0rem; padding-bottom: 0.5rem">
        <div class="dash-type"></div>
      </div>
      <div
        style="
          font-size: 1rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="label">No. Pesanan</span> <span class="separator">:</span>
        <span class="content">APC1623235634082766601</span>
      </div>
      <div
        style="
          font-size: 1rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="label">Kategori</span> <span class="separator">:</span>
        <span class="content">GAME EPIN</span>
      </div>
      <div
        style="
          font-size: 1rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="label">Tanggal Kadaluarsa</span>
        <span class="separator">:</span> <span class="content">21/08/2021</span>
      </div>
      <div
        style="
          font-size: 1rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0.5rem;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="label">No. Ref</span> <span class="separator">:</span>
        <span class="content">1623235634467600082</span>
      </div>
      <div data-id="" style="padding-top: 0rem; padding-bottom: 0.5rem">
        <div class="dash-type"></div>
      </div>
      <div
        style="
          font-size: 1.2rem;
          text-align: left;
          padding-top: 0rem;
          padding-bottom: 0rem;
          font-weight: bold;
        "
        data-id=""
        class="dynamic-type"
      >
        <span class="label">Total Bayar</span> <span class="separator">:</span>
        <span class="content">Rp 15.360</span>
      </div>
    </div>
    <iframe src="#" id="iframe" style="display: none"></iframe>
    <script src="https://static.test.mitra.shopee.co.id/dp-configuration/invoice/lib/postmessage.js?t=1623321135142"></script>
    <script src="https://static.test.mitra.shopee.co.id/dp-configuration/invoice/lib/html2canvas.js?t=1623321135142"></script>
    <script>
      (function () {
        // image monitor部分
        var iframe = document.getElementById('iframe');
        var imageCount = document.images.length;
        var failedImage = [];
        var successfulImage = [];
        var failed = false;
        var SUCCESSFUL_URL =
          'shopee://com.print.image.load/success?data=jsonString';
        var FAILED_URL = 'shopee://com.print.image.load/failure?data=jsonStrin';
        function sendMessage(msg, maxNum) {
          var num = 0;
          maxNum = maxNum || 1;
          var interval = setInterval(() => {
            if (num > maxNum) {
              clearInterval(interval);
            }
            // window.postMessage(msg);
            console.log(msg);
            num++;
          }, 1000);
        }

        function getCapture() {
          html2canvas(document.body, {
            allowTaint: true,
            useCORS: true,
          }).then((canvas) => {
            var imageUrl = canvas.toDataURL();
            sendMessage(imageUrl);
          });
        }
        var timer = setTimeout(() => {
          if (successfulImage.length !== imageCount) {
            sendMessage('error');
            failed = true;
            iframe.src = FAILED_URL;
          }
        }, 7000);

        if (imageCount === 0) {
          clearTimeout(timer);
          getCapture();
          iframe.src = SUCCESSFUL_URL;
        }
        for (var index = 0; index < imageCount; index++) {
          const imageOnLoad = function () {
            if (failed) return;
            successfulImage.push(image);
            if (successfulImage.length === imageCount) {
              clearTimeout(timer);
              getCapture();
              iframe.src = SUCCESSFUL_URL;
            }
          };
          var image = document.images[index];
          if (image.complete) imageOnLoad();
          image.onload = imageOnLoad;
          image.onerror = function () {
            sendMessage('error');
            iframe.src = FAILED_URL;
            failedImage.push(image);
          };
        }
        // ua monitor部分
        var ua = navigator.userAgent;
        function isAndroid() {
          return /Android/i.test(ua);
        }
        function isIos() {
          return /iPhone|iPad|iPod|iOS/i.test(ua);
        }
        function isWeb() {
          return /windows|win32|win64|wow32|wow64|macintosh|macintel|x11/i.test(
            ua
          );
        }
        function getPlatform() {
          if (isWeb()) return 'web';
          if (isAndroid()) return 'android';
          if (isIos()) return 'ios';
          return '';
        }
        var page = document.querySelector('#container');
        var classList = page.getAttribute('class');
        page.setAttribute(
          'class',
          classList ? classList + ' ' + getPlatform() : getPlatform()
        );
      })();
    </script>
  </body>
</html>
